Sexo, Idade,
TNFa01, TNFa02,
ICAM1, ICAM2,
PCR01, PCR02,
IL601, IL602,
VCAM1, VCAM2
)
base_inflamacao
base_inflamacao %>%
select(TNFa01, TNFa02) %>%
na.omit()
base_inflamacao %>%
select(TNFa01, TNFa02)
base_inflamacao %>%
select(TNFa01, TNFa02) %>%
na.omit()
base_tnf <-
base_inflamacao %>%
select(TNFa01, TNFa02) %>%
na.omit()
library(gather)
library(tidyr)
base_tnf <-
base_inflamacao %>%
select(TNFa01, TNFa02) %>%
na.omit() %>%
gather()
base_tnf
base_tnf$key
base_tnf %>% summary()
base_tnf
base_inflamacao %>%
select(TNFa01, TNFa02) %>%
na.omit() %>% summary()
base_tnf <-
base_inflamacao %>%
select(TNFa01, TNFa02) %>%
na.omit()
base_tnf %>% summary()
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value)) +
geom_boxplot()
base_tnf
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot()
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado \n antes e depois")
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado \n antes e depois") +
legend(fill = NULL)
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado \n antes e depois") +
legend(fill = F)
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado \n antes e depois") +
legend(fill = NULL)
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado \n antes e depois")
## ICAM
base_icam <-
base_inflamacao %>%
select(ICAM1, ICAM2) %>%
na.omit()
base_icam
base_icam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado \n antes e depois")
base_icam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot()
base_icam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "ICAM", y = "Valor observado", title = "Boxplot ICAM por valor observado \n antes e depois")
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois")
base_pcr %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "PCR", y = "Valor observado", title = "Boxplot PCR por valor observado antes e depois")
## PCR
base_pcr <-
base_inflamacao %>%
select(PCR01, PCR02) %>%
na.omit()
base_pcr %>% summary()
base_pcr
base_pcr %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "PCR", y = "Valor observado", title = "Boxplot PCR por valor observado antes e depois")
## IL-6
base_il6 <-
base_inflamacao %>%
select(PCR01, PCR02) %>%
na.omit()
base_il6 %>% summary()
base_il6
base_il6 %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "PCR", y = "Valor observado", title = "Boxplot PCR por valor observado antes e depois")
## IL-6
base_il6 <-
base_inflamacao %>%
select(IL601, IL602) %>%
na.omit()
base_il6 %>% summary()
base_il6
base_il6 %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "PCR", y = "Valor observado", title = "Boxplot PCR por valor observado antes e depois")
base_il6 %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "IL-6", y = "Valor observado", title = "Boxplot IL-6 por valor observado antes e depois")
## VCAM
base_vcam <-
base_inflamacao %>%
select(VCAM1, VCAM2) %>%
na.omit()
base_vcam %>% summary()
base_vcam
base_vcam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "IL-6", y = "Valor observado", title = "Boxplot IL-6 por valor observado antes e depois")
base_vcam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "VCAM", y = "Valor observado", title = "Boxplot VCAM por valor observado antes e depois")
## TNFa
base_tnf <-
base_inflamacao %>%
select(TNFa01, TNFa02) %>%
na.omit()
base_tnf %>% summary()
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois")
## ICAM
base_icam <-
base_inflamacao %>%
select(ICAM1, ICAM2) %>%
na.omit()
base_icam %>% summary()
base_icam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "ICAM", y = "Valor observado", title = "Boxplot ICAM por valor observado antes e depois")
## PCR
base_pcr <-
base_inflamacao %>%
select(PCR01, PCR02) %>%
na.omit()
base_pcr %>% summary()
base_pcr %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "PCR", y = "Valor observado", title = "Boxplot PCR por valor observado antes e depois")
## IL-6
base_il6 <-
base_inflamacao %>%
select(IL601, IL602) %>%
na.omit()
base_il6 %>% summary()
base_il6 %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "IL-6", y = "Valor observado", title = "Boxplot IL-6 por valor observado antes e depois")
## VCAM
base_vcam <-
base_inflamacao %>%
select(VCAM1, VCAM2) %>%
na.omit()
base_vcam %>% summary()
base_vcam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "VCAM", y = "Valor observado", title = "Boxplot VCAM por valor observado antes e depois")
base_tnf <-
base %>%
select(TNFa01, TNFa02) %>%
na.omit()
base_tnf %>% summary()
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois")
base_tnf <-
base %>%
select(TNFa01, TNFa02) %>%
na.omit()
base_tnf %>% summary()
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois")
# Em geral, com base no gráfico, parece que houve uma redução no TNFa após o RETP.
# ICAM --------------------------------------------------------------------
# Análise descritiva
base_icam <-
base %>%
select(ICAM1, ICAM2) %>%
na.omit()
base_icam %>% summary()
base_icam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "ICAM", y = "Valor observado", title = "Boxplot ICAM por valor observado antes e depois")
# Em geral, com base no gráfico, parece que houve uma redução no ICAM após o RETP.
# PCR ---------------------------------------------------------------------
# Análise descritiva
base_pcr <-
base %>%
select(PCR01, PCR02) %>%
na.omit()
base_pcr %>% summary()
base_pcr %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "PCR", y = "Valor observado", title = "Boxplot PCR por valor observado antes e depois")
# Em geral, com base no gráfico, parece que houve uma redução no PCR após o RETP.
# IL-6 --------------------------------------------------------------------
# Análise descritiva
base_il6 <-
base %>%
select(IL601, IL602) %>%
na.omit()
base_il6 %>% summary()
base_il6 %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "IL-6", y = "Valor observado", title = "Boxplot IL-6 por valor observado antes e depois")
# Em geral, com base no gráfico, parece que houve uma redução no IL-6 após o RETP.
# VCAM --------------------------------------------------------------------
# Análise descritiva
base_vcam <-
base %>%
select(VCAM1, VCAM2) %>%
na.omit()
base_vcam %>% summary()
base_vcam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "VCAM", y = "Valor observado", title = "Boxplot VCAM por valor observado antes e depois")
# Em geral, com base no gráfico, parece que houve uma redução no VCAM após o RETP.
ks.test(base_tnf$TNFa01, base_tnf$TNFa02)
ks.test(base_tnf$TNFa01)
ks.test(base_tnf$TNFa01, "pnorm")
## TNFa antes
ks.test(base_tnf$TNFa01, "pnorm", mean(base_tnf$TNFa01), sd(base_tnf$TNFa01))
shapiro.test(base_tnf$TNFa01)
## TNFa antes
shapiro.test(base_tnf$TNFa02)
base <-
read_sav("BancoTeseCris_09_07_2013.sav") %>%
mutate(
Sexo = factor(Sexo, labels = c("Homem", "Mulher"))
)
grid.arrange(graf_pew_antes, graf_pew_apos, ncol = 2)
base_tnf$TNFa01
base_tnf$TNFa01 %>% length()
t.test(base_tnf$TNFa01, base_tnf$TNFa02)
t.test(base_tnf$TNFa01, base_tnf$TNFa02, paired = T)
t.test(base_tnf$TNFa02-base_tnf$TNFa01)
t.test(base_tnf$TNFa01, base_tnf$TNFa02, alternative = "less")
t.test(base_tnf$TNFa01, base_tnf$TNFa02, alternative = "less", paired = T)
t.test(base_tnf$TNFa01, base_tnf$TNFa02, paired = T)
t.test(base_tnf$TNFa01, base_tnf$TNFa02, alternative = "two.sided", paired = T)
base_icam <-
base %>%
select(ICAM1, ICAM2) %>%
na.omit()
base_icam %>% summary()
base_icam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "ICAM", y = "Valor observado", title = "Boxplot ICAM por valor observado antes e depois")
# Normalidade: TNFa antes
shapiro.test(base_icam$ICAM1)
# Normalidade: TNFa depois
shapiro.test(base_icam$ICAM2)
t.test(base_icam$ICAM1, base_icam$ICAM2, alternative = "two.sided", paired = T)
base_pcr <-
base %>%
select(PCR01, PCR02) %>%
na.omit()
base_pcr %>% summary()
base_pcr %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "PCR", y = "Valor observado", title = "Boxplot PCR por valor observado antes e depois")
# Normalidade: TNFa antes
shapiro.test(base_pcr$PCR01)
# Normalidade: TNFa depois
shapiro.test(base_pcr$PCR02)
t.test(base_pcr$PCR01, base_pcr$PCR02, alternative = "two.sided", paired = T)
base_il6 <-
base %>%
select(IL601, IL602) %>%
na.omit()
base_il6 %>% summary()
base_il6 %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "IL-6", y = "Valor observado", title = "Boxplot IL-6 por valor observado antes e depois")
# Normalidade: TNFa antes
shapiro.test(base_il6$IL601)
# Normalidade: TNFa depois
shapiro.test(base_il6$IL602)
t.test(base_il6$IL601, base_il6$IL602, alternative = "two.sided", paired = T)
t.test(base_pcr$PCR01, base_pcr$PCR02, alternative = "two.sided", paired = T)
base_vcam <-
base %>%
select(VCAM1, VCAM2) %>%
na.omit()
base_vcam %>% summary()
base_vcam %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "VCAM", y = "Valor observado", title = "Boxplot VCAM por valor observado antes e depois")
# Normalidade: TNFa antes
shapiro.test(base_vcam$VCAM1)
# Normalidade: TNFa depois
shapiro.test(base_vcam$VCAM2)
t.test(base_vcam$VCAM1, base_vcam$VCAM2, alternative = "two.sided", paired = T)
# Visualizacao PEW ANTES
# graf_pew_antes <-
base_pew$PEW_ANTES %>% table() %>% as_tibble() %>%
ggplot() +
geom_bar(aes(x=., y=n), stat = "identity") +
theme_bw() +
labs(x = "Presença de perda", y = "Número de pacientes", title = "PEW ANTES do RETP nos pacientes") +
scale_y_continuous(limits = c(0, 30))
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois")
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois") +
scale_fill_brewer(palette = 2)
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois") +
scale_fill_brewer(c("red", "green"))
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois") +
scale_fill_brewer(palette = 1)
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois") +
scale_fill_brewer(rainbow(2))
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois") +
scale_fill_continuous()
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois") +
scale_color_brewer(palette = 2)
base_tnf %>%
gather() %>%
ggplot(aes(x = key, y = value, fill = key)) +
geom_boxplot() +
labs(x = "TNFa", y = "Valor observado", title = "Boxplot TNFa por valor observado antes e depois") +
scale_color_discrete(palette(1))
citation()
1+1
install.packages("wordcloud")
install.packages("stopwords")
install.packages("tidytext")
install.packages("magrittr")
install.packages("magrittr")
install.packages("magrittr")
install.packages("magrittr")
install.packages("magrittr")
install.packages("magrittr")
install.packages("purrr")
install.packages("purrr")
library(dplyr)
library(stringr)
# library(readr)
library(purrr)
library(magrittr)
library(tidytext)
# library(lexiconPT)
library(stopwords)
library(tidyr)
library(wordcloud)
install.packages("purrr")
install.packages("purrr")
# library(readr)
library(purrr)
install.packages("tidyverse")
install.packages("purrr", dependencies = T)
install.packages("purrr", dependencies = T)
# library(readr)
library(purrr)
library(tidyr)
# library(readr)
library(purrr)
require(purrr)
base <-
map(list.files("../data/csv"),
~ read.csv2(paste0("../data/csv/", .x), encoding = "UTF-8") %>%
cbind(presidente = .x %>% str_sub(end = -5)) %>% as_tibble
) %>%
bind_rows() %>%
nest(-presidente)
setwd("~/UFF/commit/tweetadas_presidenciais/code")
base <-
purrr::map(list.files("../data/csv"),
~ read.csv2(paste0("../data/csv/", .x), encoding = "UTF-8") %>%
cbind(presidente = .x %>% str_sub(end = -5)) %>% as_tibble
) %>%
bind_rows() %>%
nest(-presidente)
base %<>%
mutate(
tidytext = purrr::map(
data,
~ .x %>%
mutate(
tweet = as.character(tweet) %>% str_replace_all("(://|/)", ""),
line = 1:nrow(.)
) %>%
select(line, tweet) %>%
unnest_tokens(word, tweet) %>%
anti_join(.,
tibble(word = c(stopwords("pt"), .$word[grep("^http", .$word)]))
)
)
)
base %<>%
mutate(
wordcloud = purrr::walk(
tidytext,
~ .x %>%
select(word) %>%
filter(word != "é") %>%
mutate(word = str_remove_all(word, "[:number:]{1,}")) %>%
count(word, sort = T) %>%
with(wordcloud(word, n, max.words = 100, min.freq = 5, random.order = F, random.color = T, rot.per = 0.05))
)
)
base
base$wordcloud[[1]]
